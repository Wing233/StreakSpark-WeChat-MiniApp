<!-- 任务列表页面 -->
<view class="container">
  <!-- 页面标题 -->
  <view class="page-header">
    <text class="page-title">每日打卡清单</text>
    <text class="page-subtitle">{{currentDate}}</text>
  </view>
  
  <!-- 筛选器 -->
  <view class="filter-bar">
    <view class="filter-tabs">
      <view class="tab {{activeTab === 'all' ? 'active' : ''}}" bindtap="switchTab" data-tab="all">全部</view>
      <view class="tab {{activeTab === 'pending' ? 'active' : ''}}" bindtap="switchTab" data-tab="pending">待完成</view>
      <view class="tab {{activeTab === 'completed' ? 'active' : ''}}" bindtap="switchTab" data-tab="completed">已完成</view>
    </view>
  </view>
  
  <!-- 任务列表 -->
  <view class="task-list">
    <block wx:if="{{tasks.length > 0}}">
      <view wx:for="{{filteredTasks}}" wx:key="_id" class="task-card {{item.completed ? 'completed' : ''}}" bindtap="goToDetail" data-id="{{item._id}}">
        <!-- 完成状态选择框 -->
        <view class="task-checkbox" bindtap="selectTask" data-index="{{index}}">
          <view class="checkbox {{item.completed ? 'checked' : ''}}">
            <text class="checkbox-icon" wx:if="{{item.completed}}">✓</text>
          </view>
        </view>
        
        <!-- 任务内容 -->
        <view class="task-content">
          <text class="task-title">{{item.title}}    </text>
          <text class="task-description" wx:if="{{item.description}}">{{item.description}}</text>
          <!-- 任务时间 -->
          <view class="task-time">
            <text wx:if="{{item.completed}}" class="completed-time">完成于 {{item.formattedCompletedAt || '无'}}</text>
            <text wx:else class="created-time">创建于 {{item.formattedCreatedAt || '无'}}</text>
          </view>
        </view>
        
        <!-- 操作按钮 -->
        <view class="task-actions">
          <image class="action-icon" src="/images/more.png" mode="aspectFit" bindtap="showActionMenu" data-id="{{item._id}}" data-index="{{index}}" catchtap="stopPropagation"></image>
        </view>
      </view>
    </block>
    
    <!-- 空状态 -->
    <view class="empty-state" wx:else>
      <image class="empty-state-icon" src="/images/empty.svg" mode="aspectFit"></image>
      <text class="empty-state-text">暂无任务</text>
      <text class="empty-state-subtext">点击下方"添加任务"按钮创建第一个任务吧！</text>
    </view>
  </view>
  
  <!-- 操作菜单 -->
  <view class="action-menu" wx:if="{{showActionMenu}}">
    <view class="menu-item" bindtap="editTask" catchtap="closeActionMenu">
      <text>编辑任务</text>
    </view>
    <view class="menu-item delete" bindtap="deleteTask" catchtap="closeActionMenu">
      <text>删除任务</text>
    </view>
    <view class="menu-item cancel" bindtap="closeActionMenu">
      <text>取消</text>
    </view>
  </view>

  <!-- 底部信息 -->
  <view class="footer">
    <text class="copyright">© 2025 每日打卡清单</text>
  </view>
</view>